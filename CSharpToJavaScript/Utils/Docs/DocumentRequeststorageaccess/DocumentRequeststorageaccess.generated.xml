<docs>
<DocumentRequestStorageAccess>
<summary>
The <strong><c>requestStorageAccess()</c></strong> method of the <see cref="Document"/> interface allows content loaded in a third-party context (i.e., embedded in an {{htmlelement("iframe")}}) to request access to <see href="https://developer.mozilla.org/en-US/docs/Web/Privacy/Third-party_cookies">third-party cookies</see> and <see href="https://developer.mozilla.org/en-US/docs/Web/Privacy/State_Partitioning#state_partitioning">unpartitioned state</see>. This is relevant to user agents that, by default, block access to third-party, <see href="https://developer.mozilla.org/en-US/docs/Web/API/Storage_Access_API#unpartitioned_versus_partitioned_cookies">unpartitioned</see> cookies to improve privacy (e.g., to prevent tracking), and is part of the <see href="https://developer.mozilla.org/en-US/docs/Web/API/Storage_Access_API">Storage Access API</see>.
</summary>
<remarks>
<para>To check whether permission to access third-party cookies has already been granted, you can call <see cref="Permissions.Query"/>, specifying the feature name <c>&amp;quot;storage-access&amp;quot;</c>.</para><blockquote><para>Usage of this feature may be blocked by a <see href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy/storage-access">Permissions-Policy/storage-access</see> <see href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Permissions_Policy">Permissions Policy</see> set on your server. In addition, the document must pass additional browser-specific checks such as allowlists, blocklists, on-device classification, user settings, anti-<see href="https://developer.mozilla.org/en-US/docs/Web/Security/Attacks/Clickjacking">clickjacking</see> heuristics, or prompting the user for explicit permission.</para></blockquote>
<para>-<see cref="Document.HasStorageAccess"/>, <see cref="Document.HasUnpartitionedCookieAccess"/>, <see cref="Document.RequestStorageAccessFor"/><br/>-<see href="https://developer.mozilla.org/en-US/docs/Web/API/Storage_Access_API/Using">Using the Storage Access API</see><br/>-<see href="https://webkit.org/blog/8124/introducing-storage-access-api/">Introducing Storage Access API</see> (WebKit blog)<br/></para>
<para><seealso href="https://developer.mozilla.org/en-US/docs/Web/API/Document/requestStorageAccess"> <em>See also on MDN</em> </seealso></para>
</remarks>
<returns>A <see cref="Promise"/> that fulfills with <c>undefined</c> if the access to third-party cookies was granted and no <c>types</c> parameter was provided, fulfills with <see cref="StorageAccessHandle"/> if the access to unpartitioned state requested by the <c>types</c> parameter was provided, and rejects if access was denied.<c>requestStorageAccess()</c> requests are automatically denied unless the embedded content is currently processing a user gesture such as a tap or click (<see href="https://developer.mozilla.org/en-US/docs/Glossary/transient activation">transient activation</see>), or unless permission was already granted previously. If permission was not previously granted, they need to be run inside a user gesture-based event handler. The user gesture behavior depends on the state of the promise:</returns>
</DocumentRequestStorageAccess>
</docs>